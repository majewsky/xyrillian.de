<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Speicherschutz - Xyrillian Noises</title>
  <link rel="stylesheet" href="/res/xyrillian.css" />
</head>
<body class="noises episode-stp has-nav-top-card">
  <nav class="top-card">
    <div>
      <a href="/noises/">
        <img class="sitelogo" src="/res/logo-noises.svg" alt="Xyrillian Noises Hörfunkproduktion">
      </a>
    </div>
  </nav>
  <header>
    <a class="coverart" href="/noises/stp/">
      <img src="/res/cover-stp.svg" alt="Cover-Art für: Schlüsseltechnologie">
    </a>
    <h2><a href="/noises/stp">Schlüsseltechnologie</a> #19 vom 12. Mai 2022</h2>
    <h1>Speicherschutz</h1>
      <p>Nach einem glorreichen Intro mit perfekter Vorbereitung befassen Xyrill und ttimeless sich mit Speicherschutz.
Wie und warum und welchen Speicher überhaupt? Hört selbst.</p>
      <p><strong>Länge:</strong> 55:36 Minuten</p>
  </header>
    <audio controls preload="none">
        <source src="/dl/stp-019-speicherschutz.mp3" type="audio/mpeg">
        <source src="/dl/stp-019-speicherschutz.ogg" type="audio/ogg">
        <source src="/dl/stp-019-speicherschutz.opus" type="audio/opus">
      <div class="audio-not-supported">
        <span>Webplayer nicht vom Browser unterstützt</span>
      </div>
    </audio>
    <div id="chapters">
      <div class="chapter" data-start="0" data-end="73.44">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">00:00</span>
        <span class="chapter-title">Intro</span>
      </div>
      <div class="chapter" data-start="73.44" data-end="270.005">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">01:13</span>
        <span class="chapter-title">Welchen Speicher müssen wir eigentlich schützen?</span>
      </div>
      <div class="chapter" data-start="270.005" data-end="453">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">04:30</span>
        <span class="chapter-title">Aufgaben des Betriebssystems: Prozessisolation und Vermittlung des Hardwarezugriffs</span>
      </div>
      <div class="chapter" data-start="453" data-end="768">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">07:33</span>
        <span class="chapter-title">Antwort auf Frage 1: Prozessor-Ringe</span>
      </div>
      <div class="chapter" data-start="768" data-end="1305">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">12:48</span>
        <span class="chapter-title">Wie kommen wir von einem niedrigeren in einen höheren Ring?</span>
      </div>
      <div class="chapter" data-start="1305" data-end="1683">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">21:45</span>
        <span class="chapter-title">Antwort auf Frage 2: Virtuelle Speicherverwaltung</span>
      </div>
      <div class="chapter" data-start="1683" data-end="1822">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">28:03</span>
        <span class="chapter-title">Paging</span>
      </div>
      <div class="chapter" data-start="1822" data-end="2688">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">30:22</span>
        <span class="chapter-title">Swapping</span>
      </div>
      <div class="chapter" data-start="2688" data-end="2796.02">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">44:48</span>
        <span class="chapter-title">Memory-Mapping</span>
      </div>
      <div class="chapter" data-start="2796.02" data-end="3005">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">46:36</span>
        <span class="chapter-title">Direct Memory Access</span>
      </div>
      <div class="chapter" data-start="3005" data-end="3336.648">
        <div class="chapter-progress"><div class="chapter-progress-filler">&nbsp;</div></div>
        <span class="chapter-start" title="Zur Kapitelmarke springen">50:05</span>
        <span class="chapter-title">Warum das alles? und Gesellschaftliche Indikationen</span>
      </div>
    </div>
    <section>
      <h3>Download</h3>
      <ul>
          <li><a href="/dl/stp-019-speicherschutz.mp3">MP3</a> (51,2 MiB)</li>
          <li><a href="/dl/stp-019-speicherschutz.ogg">Ogg Vorbis</a> (29,9 MiB)</li>
          <li><a href="/dl/stp-019-speicherschutz.opus">Opus</a> (19,0 MiB)</li>
      </ul>
    </section>
    <section>
      <h3>Shownotes</h3>
      <p><ul>
<li>
<p>&quot;Welchen Speicher müssen wir eigentlich schützen?&quot;</p>
<ul>
<li>hier nur Arbeitsspeicher und Gerätespeicher</li>
<li>andere Speicherarten (z.B. Festplatten) geschützt durch die Betriebssystem-Abstraktionen, siehe zukünftige Folge zu Privilegienkontrolle</li>
</ul>
</li>
<li>
<p>Aufgaben des Betriebssystems: Prozessisolation und Vermittlung des Hardwarezugriffs</p>
<ul>
<li>Problem: das Betriebssystem ist auch nur &quot;ein Programm&quot;</li>
<li>Frage 1: Wie wird sichergestellt, dass das Betriebssystem die finale Kontrolle über Hardwarezugriffe hat?</li>
<li>Frage 2: Wie wird verhindert, dass ein Speicherbereich, den Prozess A verwendet, von Prozess B überschrieben (oder unberechtigterweise ausgelesen) wird?</li>
</ul>
</li>
<li>
<p>Antwort auf Frage 1: <a href="https://de.wikipedia.org/wiki/Ring_(CPU)">Prozessor-Ringe</a></p>
<ul>
<li>Standardfunktion auf allen CPUs, die auf Mehrprozess-Betrieb ausgelegt sind (nicht immer im Embedded-Bereich)</li>
<li>zu jedem Zeitpunkt läuft der Prozess in einem von mehreren Ringen</li>
<li>sensible Operationen (v.a. Hardwarezugriff) sind nur in den höheren Ringen erlaubt und damit den Betriebssystemprozessen vorbehalten</li>
<li>Wechsel in einen niedrigeren Ring jederzeit möglich (z.B. Aktivierung eines Userspace-Prozesses durch das Betriebssystem)</li>
</ul>
</li>
<li>
<p>Wie kommen wir von einem niedrigeren Ring wieder in einen höheren Ring?</p>
<ul>
<li>Interrupts (siehe STP015): Eintreten eines Hardware-Ereignisses (z.B. ankommendes Netzwerk-Paket oder abgelaufener Hardware-Timer), das durch das Betriebssystem behandelt werden muss</li>
<li><strong>Syscalls</strong>: niedrigprivilegierter Prozess fragt eine definierte Schnittstelle des Betriebssystems an, um eine höherprivilegierte Operation auszuführen</li>
<li>z.B. Dateisystem-Zugriff, Hardware-Zugriff, Ändern der Betriebssystem-Konfiguration, Starten von neuen Prozessen, Nachrichtenübermittlung an andere Prozesse</li>
<li>dadurch Realisierung der Prozessisolation, weil das Betriebssystem die Kontrolle über alle privilegierten Operationen hat</li>
</ul>
</li>
<li>
<p>Antwort auf Frage 2: <a href="https://de.wikipedia.org/wiki/Virtuelle_Speicherverwaltung">Virtuelle Speicherverwaltung</a></p>
<ul>
<li>wenn Prozesse auf Speicher zugreifen, verwenden sie nur &quot;virtuelle&quot; Speicheradressen: z.B. Adresse 0x42 für Prozess A ist nicht unbedingt derselbe Speicher wie Adresse 0x42 für Prozess B</li>
<li>Abbildung auf physische Speicheradressen innerhalb der CPU durch eine <strong>Memory Management Unit</strong> (MMU)</li>
<li>Konfiguration der MMU durch das Betriebssystem immer kurz vor der Übergabe der CPU an einen anderen Prozess</li>
<li>Aufteilung des physischen/virtuellen Speichers in Seiten (<strong>Pages</strong>), z.B. bei x86-64 wahlweise 4 KiB oder 2 MiB oder 1 GiB</li>
<li>pro Page verschiedene Zugriffsberechtigungen möglich, z.B. zur Verhinderung des Schreibens in ausführbare Programmteile, oder für <strong>Shared Memory</strong> als Kommunikationsweg zwischen Prozessen</li>
</ul>
</li>
<li>
<p>Paging der MMU ermöglicht <strong>Swapping</strong></p>
<ul>
<li>Pages müssen nicht unbedingt im tatsächlichen Arbeitsspeicher gehalten werden, sondern können bei Nichtverwendung in eine Swap-Datei auf der Festplatte ausgelagert werden</li>
<li>dadurch über alle Programme summiert meist deutlich mehr virtueller Speicher zugewiesen, als tatsächlich physischer Speicher vorhanden ist</li>
<li>wenn ein Programm auf eine im Arbeitsspeicher fehlende Seite zugreift, erzeugt die MMU einen Interrupt (<strong>Page Fault</strong>), sodass das Betriebssystem die fehlende Seite transparent nachladen kann</li>
<li>analog dazu: <strong>Memory-Mapping</strong> von Dateiinhalten direkt in den Arbeitsspeicher</li>
</ul>
</li>
<li>
<p>wenn wir schon mal über Speicheradressen reden: <a href="https://de.wikipedia.org/wiki/Direct_Memory_Access">Direct Memory Access</a></p>
<ul>
<li>Abbildung eines Arbeitsspeicher-Addressbereiches auf einen Speicher eines angeschlossenen Gerätes, zum Beispiel den Arbeitsspeicher der Grafikkarte oder eines Netzwerkadapters</li>
<li>dadurch direkter Transfer von Daten zwischen niedrigprivilegierten Prozessen und Hardware möglich, z.B. schnelles Hochladen von Texturen in die Grafikkarte durch ein 3D-Spiel</li>
<li>DMA braucht nicht unbedingt eine MMU (siehe <a href="https://wiki.osdev.org/Printing_to_Screen">VGA-Buffer bei <code>0xB8000</code></a> in DOS-Ära-Betriebssystemen)</li>
</ul>
</li>
</ul></p>
    </section>
    <section>
      <h3>Audioquellen<span>&nbsp;in Abspielreihenfolge (soweit nicht gemeinfrei)</span></h3>
      <ul>
          <li><a href="https://freesound.org/people/MastersDisaster/sounds/218115/">MastersDisaster: &quot;Switch ON - Livingroom (Sample)&quot;</a></li>
          <li><a href="https://freesound.org/people/Garuda1982/sounds/538915/">Garuda1982: &quot;Switch on the fluorescent tube sound effect&quot;</a></li>
          <li><a href="https://www.youtube.com/watch?v=n8Yo-wD-QTo&amp;t=129s">Konrad Zuse: &quot;HR-Fernsehbericht von 1958&quot;</a></li>
          <li><a href="https://www.youtube.com/watch?v=jbrMBOF61e0&amp;t=9s">Donald Knuth: &quot;Lehrveranstaltung von 1981&quot;</a></li>
      </ul>
    </section>

  <footer class="legal">
    <a href="/legal/de/">Impressum/Datenschutz</a>
  </footer>
  <script async src="/res/chapter-marks.js"></script>
</body>
</html>
